<root>
<let id = "maj" > 
          <qvexp op = "id" type = "Nor" > x </qvexp> <vexp op = "id" type = "Nat" > n </vexp>
          <qvexp op = "id" type = "Nor" > y </qvexp> <vexp op = "id" type = "Nat" > m </vexp>
          <qvexp op = "id" type = "Nor" > z </qvexp> <vexp op = "id" type = "Nat" > j </vexp>
    <pexp gate = "CU" id = "z" > <vexp op = "id" > j </vexp> <pexp gate = "X" id = "y" >  <vexp op = "id" > m </vexp> </pexp></pexp>
    <pexp gate = "CU" id = "z" > <vexp op = "id" > j </vexp> <pexp gate = "X" id = "x" >  <vexp op = "id" > n </vexp> </pexp></pexp>
    <pexp gate = "CU" id = "x" > <vexp op = "id" > n </vexp> <pexp gate = "CU" id = "y" >  <vexp op = "id" > m </vexp> 
            <pexp gate = "X" id = "z" > <vexp op = "id" > j </vexp> </pexp> </pexp></pexp>
</let>

<let id = "uma" > 
          <qvexp op = "id" type = "Nor" > x </qvexp> <vexp op = "id" type = "Nat" > n </vexp>
          <qvexp op = "id" type = "Nor" > y </qvexp> <vexp op = "id" type = "Nat" > m </vexp>
          <qvexp op = "id" type = "Nor" > z </qvexp> <vexp op = "id" type = "Nat" > j </vexp>
    <pexp gate = "CU" id = "x" > <vexp op = "id" > n </vexp> <pexp gate = "CU" id = "y" >  <vexp op = "id" > m </vexp> 
            <pexp gate = "X" id = "z" > <vexp op = "id" > j </vexp> </pexp> </pexp></pexp>
    <pexp gate = "CU" id = "z" > <vexp op = "id" > j </vexp> <pexp gate = "X" id = "x" >  <vexp op = "id" > n </vexp> </pexp></pexp>
    <pexp gate = "CU" id = "z" > <vexp op = "id" > j </vexp> <pexp gate = "X" id = "y" >  <vexp op = "id" > m </vexp> </pexp></pexp>
</let>

<let id = "majseq" >
 <vexp op = "id" type = "Nat" > n </vexp> 
 <vexp op = "id" type = "Nat" > size </vexp> 
  <qvexp op = "id" type = "Nor(size)" > x </qvexp>
  <qvexp op = "id" type = "Nor(size)" > y </qvexp>
  <qvexp op = "id" type = "Nor(1)" > c </qvexp>
   <match id = "n" >
          <pair case = "0" > <app id = "maj" > <qvexp op = "id" > c </qvexp> <vexp op = "num" > 0 </vexp> <qvexp op = "id" > y </qvexp> <vexp op = "num" > 0 </vexp> <qvexp op = "id" > x </qvexp>
           <vexp op = "num" > 0 </vexp> </app> </pair>
          <pair case = "m" >
          <app id = "majseq" > <vexp op = "id" > m </vexp> <vexp op = "id" > size </vexp> <qvexp op = "id" > x </qvexp> <qvexp op = "id" > y </qvexp> <qvexp op = "id" > c </qvexp> </app>
          <app id = "maj" > <qvexp op = "id" > x </qvexp> <vexp op = "id" > m </vexp> <qvexp op = "id" > y </qvexp>
              <vexp op = "id" > n </vexp> <qvexp op = "id" > x </qvexp> <vexp op = "id" > n </vexp> </app>
          </pair>
   </match>
</let>

<let id = "umaseq" > 
 <vexp op = "id" type = "Nat" > n </vexp> 
 <vexp op = "id" type = "Nat" > size </vexp> 
  <qvexp op = "id" type = "Nor(size)" > x </qvexp>
  <qvexp op = "id" type = "Nor(size)" > y </qvexp>
  <qvexp op = "id" type = "Nor(1)" > c </qvexp>
   <match id = "n" >
          <pair case = "0" > <app id = "uma" > <qvexp op = "id" > c </qvexp> <vexp op = "num" > 0 </vexp> <qvexp op = "id" > y </qvexp> <vexp op = "num" > 0 </vexp> <qvexp op = "id" > x </qvexp>
           <vexp op = "num" > 0 </vexp> </app> </pair>
          <pair case = "m" >
          <app id = "uma" > <qvexp op = "id" > x </qvexp> <vexp op = "id" > m </vexp> <qvexp op = "id" > y </qvexp>
              <vexp op = "id" > n </vexp> <qvexp op = "id" > x </qvexp> <vexp op = "id" > n </vexp> </app>
          <app id = "umaseq" > <vexp op = "id" > m </vexp> <vexp op = "id" > size </vexp> <qvexp op = "id" > x </qvexp> <qvexp op = "id" > y </qvexp> <qvexp op = "id" > c </qvexp> </app>
          </pair>
   </match>
</let>

<let id = "f" >
  <vexp op = "id" type = "Nat" > n </vexp> 
  <vexp op = "id" type = "Nat" > size </vexp> 
  <qvexp op = "id" type = "Nor(size)" > x </qvexp>
  <qvexp op = "id" type = "Nor(size)" > y </qvexp>
  <qvexp op = "id" type = "Nor(1)" > c </qvexp>
             <app id = "majseq" > <vexp op = "-"> <vexp op = "id" > n </vexp> <vexp op = "num" > 1 </vexp> </vexp> 
                             <qvexp op = "id" > x </qvexp> <qvexp op = "id" > y </qvexp> <qvexp op = "id" > c </qvexp> </app>
             <app id = "umaseq" > <vexp op = "-"> <vexp op = "id" > n </vexp> <vexp op = "num" > 1 </vexp> </vexp> 
                             <qvexp op = "id" > x </qvexp> <qvexp op = "id" > y </qvexp> <qvexp op = "id" > c </qvexp> </app>
</let>
<app id = "f" > 
 <vexp op = "id" type = "Nat" > na </vexp>
 <vexp op = "id" type = "Nat" > size </vexp> 
 <qvexp op = "id" type = "Nor(size)" > xa </qvexp>
 <qvexp op = "id" type = "Nor(size)" > ya </qvexp>
 <qvexp op = "id" type = "Nor(1)" > ca </qvexp>
  </app>
</root>

